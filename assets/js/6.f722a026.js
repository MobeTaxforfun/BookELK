(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{434:function(a,t,s){a.exports=s.p+"assets/img/putindexmappingsproperties.d6a5d0a6.png"},435:function(a,t,s){a.exports=s.p+"assets/img/addnewfield.2cbdd4cb.png"},436:function(a,t,s){a.exports=s.p+"assets/img/searchmappingofindex.46642f6c.png"},437:function(a,t,s){a.exports=s.p+"assets/img/searchspecificfield.21c3a93d.png"},465:function(a,t,s){"use strict";s.r(t);var e=s(65),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"elasticsearch-mapping"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-mapping"}},[a._v("#")]),a._v(" Elasticsearch Mapping")]),a._v(" "),e("p",[a._v("在 Index 中的 Mapping 用來定義索引中的欄位名稱與類型，"),e("strong",[a._v("相當於關聯型數據庫中創建Table時指定的 Schema")]),a._v("，但在 Elasticsearch 並不一定要指定 Index Mapping 才能儲存資料 Elasticsearch 其特有的 Dynamic Mapping 機制也可以根據鍵入的資料來生成相對應的 Mapping field")]),a._v(" "),e("ul",[e("li",[a._v("在創建索引時，順便設計類型就跟使用 SQL 一樣")]),a._v(" "),e("li",[a._v("官方 Mapping "),e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("走這裡"),e("OutboundLink")],1)]),a._v(" "),e("li",[a._v("關於 body 裡面可以設定的參數 "),e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-params.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("走這裡"),e("OutboundLink")],1)])]),a._v(" "),e("h2",{attrs:{id:"如何使用-index-mapping"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何使用-index-mapping"}},[a._v("#")]),a._v(" 如何使用 Index Mapping")]),a._v(" "),e("p",[a._v('在創建索引時;透過 "mappings" 來指定，Field data Type 可以看這邊 '),e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方文件"),e("OutboundLink")],1)]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("PUT /my-user-000001\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mappings"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"age"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v("    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"integer"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",  \n      "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"email"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"keyword"')]),a._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(", \n      "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v("   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"text"')]),a._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("     \n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("p",[e("img",{attrs:{src:s(434),alt:"創建索引並附加屬性"}})]),a._v(" "),e("ul",[e("li",[a._v("age 為 integer : 毫無反應；就是一個整數")]),a._v(" "),e("li",[a._v("email 為 keyword : 若指定為 keyworld，將不會享有全文搜索的特性，單單視為普通參數做使用\n"),e("blockquote",[e("p",[a._v("Avoid using keyword fields for full-text search. Use the text field type instead.")])])]),a._v(" "),e("li",[a._v("name 為 text : 若指定為 text，這個 Field 將會經過 "),e("code",[a._v("analysis")]),a._v(" 分詞轉換為全文索引 analysis 是 Elasticsearch 中一個非常重要機制\n"),e("blockquote",[e("p",[a._v("A field to index full-text values, such as the body of an email or the description of a product. These fields are analyzed, that is they are passed through an analyzer to convert the string into a list of individual terms before being indexed.")])])])]),a._v(" "),e("h2",{attrs:{id:"添加新字段"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加新字段"}},[a._v("#")]),a._v(" 添加新字段")]),a._v(" "),e("p",[a._v("添加一個 "),e("code",[a._v("employee-id")]),a._v(" 的 "),e("code",[a._v("keyword")]),a._v(" 字段，並指定其 index 的屬性為 false ; 當 index 屬性被指定為 false 時，通常代表這個 field (此處為 "),e("code",[a._v("employee-id")]),a._v(") 不會被建立索引或不可透過此字段進行查詢，僅是為了呈現數據而使用")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("PUT /my-user-000001/_mapping\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"properties"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"employee-id"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"keyword"')]),a._v(",\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"index"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("p",[e("img",{attrs:{src:s(435),alt:"添加新字段到已經存在的Index中"}})]),a._v(" "),e("h2",{attrs:{id:"更新字段"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新字段"}},[a._v("#")]),a._v(" 更新字段")]),a._v(" "),e("p",[a._v("除了指定的 Mapping parameters (設定參數"),e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-params.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("這裡"),e("OutboundLink")],1),a._v(")外，基本上"),e("strong",[a._v("沒辦法更新")]),a._v("已經指定的 mapping 或 field type，更新已存在的 field 會造成索引失效，在 es 中索引是很敏感的存在")]),a._v(" "),e("blockquote",[e("p",[a._v("Except for supported mapping parameters, you can’t change the mapping or field type of an existing field. Changing an existing field could invalidate data that’s already indexed.")])]),a._v(" "),e("p",[a._v("但還是可以透過 reindex 與 alias 的機制來解決")]),a._v(" "),e("h2",{attrs:{id:"查詢-mapping-of-an-index"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查詢-mapping-of-an-index"}},[a._v("#")]),a._v(" 查詢 mapping of an index")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("GET /my-user-000001/_mapping\n")])])]),e("p",[e("img",{attrs:{src:s(436),alt:"查詢映射"}})]),a._v(" "),e("h2",{attrs:{id:"查詢某個指定的-field"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查詢某個指定的-field"}},[a._v("#")]),a._v(" 查詢某個指定的 field")]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("GET /my-user-000001/_mapping/field/employee-id\n")])])]),e("p",[e("img",{attrs:{src:s(437),alt:"查詢指定字段"}})])])}),[],!1,null,null,null);t.default=n.exports}}]);