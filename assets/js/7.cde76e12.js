(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{469:function(s,e,a){s.exports=a.p+"assets/img/elastichost.4d6faea4.png"},470:function(s,e,a){s.exports=a.p+"assets/img/kibanahost.e6de3560.png"},471:function(s,e,a){s.exports=a.p+"assets/img/logstashhost.a0a0f4f8.png"},472:function(s,e){s.exports="data:image/png;base64,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"},473:function(s,e,a){s.exports=a.p+"assets/img/NGINXhost.4fc5b206.png"},510:function(s,e,a){"use strict";a.r(e);var t=a(65),r=Object(t.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"elastic-stack-環境建置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elastic-stack-環境建置"}},[s._v("#")]),s._v(" Elastic stack 環境建置")]),s._v(" "),t("p",[s._v("為了輕鬆玩耍 Elastic Stack 需要先準備環境，以下紀錄一下自己用 Docker 搭建 Elastic Stack 各項服務的過程")]),s._v(" "),t("p",[s._v("🌏 環境")]),s._v(" "),t("ul",[t("li",[s._v("OS Windows 10")]),s._v(" "),t("li",[s._v("Docker Desktop 4.9.1")]),s._v(" "),t("li",[s._v("Elastic stack 各項服務已 7.17.4 為主要版本號")]),s._v(" "),t("li",[s._v("Using the WSL 2 backend")])]),s._v(" "),t("p",[s._v("🌏 想參考此篇的你須具備 Docker 與編寫 Docker Compose 的相關知識，注意事項如下:")]),s._v(" "),t("ul",[t("li",[s._v("直接在 Windows 用指令建置環境實在太陰間(Docker bind amount 在 Window 環境下會有些許路徑問題)，所以最後產出將會是使用 Docker Compose 來啟動環境")]),s._v(" "),t("li",[s._v("請配置適合的記憶體空間給 Docker Desktop，Elastic Stack 需要一定的記憶體空間，請依據環境中的 Docker 配置此篇使用WSL2")]),s._v(" "),t("li",[s._v("Docker Commands 傳送門 "),t("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/engine/reference/commandline/docker/"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"行前準備"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#行前準備"}},[s._v("#")]),s._v(" 行前準備")]),s._v(" "),t("p",[s._v("已 WSL2 的基本配置大機率是啟動不了此篇 Elastic stack 的全部服務，配置一下 WSL2 的相關記憶體設定，在這個路徑下面添加設定檔(根據當下 Docker 環境設定記憶體)")]),s._v(" "),t("p",[t("code",[s._v("C:\\Users\\{UserName}\\.wslconfig")])]),s._v(" "),t("p",[s._v("設定檔裡面添加記憶體 (memory) 的設定")]),s._v(" "),t("div",{staticClass:"language-EditorConfig extra-class"},[t("pre",{pre:!0,attrs:{class:"language-editorconfig"}},[t("code",[t("span",{pre:!0,attrs:{class:"token section selector"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("wsl2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("memory")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("4GB")]),s._v("\n")])])]),t("p",[s._v("WSL2幾個實用指定:")]),s._v(" "),t("ul",[t("li",[s._v("View the list of distros and their current state : "),t("code",[s._v("wsl -l -v")])]),s._v(" "),t("li",[s._v("Shutdown everything : "),t("code",[s._v("wsl --shutdown")])]),s._v(" "),t("li",[s._v("Boot up the default distro : "),t("code",[s._v("wsl")])]),s._v(" "),t("li",[s._v("Boot up a specific distro : "),t("code",[s._v("wsl -d <DistroName>")])])]),s._v(" "),t("h2",{attrs:{id:"elastic-stack-最基本架構"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elastic-stack-最基本架構"}},[s._v("#")]),s._v(" Elastic stack 最基本架構")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Elasticsearch")]),s._v(" "),t("p",[s._v("做為整個 Elastic stack 服務的核心，一個以 Lucene 為基礎實現的全文索引 NoSQL 資料庫，最終所有的資料與數據將在此處持久化")])]),s._v(" "),t("li",[t("p",[s._v("Kibana")]),s._v(" "),t("p",[s._v("此服務提供 UI 介面來操作持久化在 Elasticsearch 中的資料，並提供視覺化儀表板，另外也可以作為管理 Elastic stack 相關服務的後台")])]),s._v(" "),t("li",[t("p",[s._v("Logstash")]),s._v(" "),t("p",[s._v("通常出現 Elasticsearch 之前，用於數據再倒入 Elasticsearch 之前，將資料清洗並輸入，主要由三個部分組成分別是 Input > Filter > Output，之後會再 Logstash 的設定中看到")])]),s._v(" "),t("li",[t("p",[s._v("FileBeat")]),s._v(" "),t("p",[s._v('其原始稱呼其實為 "Beats"，用於將資料傳輸至 Elasticsearch 或 Logstash，這邊使用 FileBeat， Elastic stack 中 "Beats" 的總類有很多種常見的有 Metricbeat、Filebeat、WinLogBeat、Heartbeat......等等，可以依需求使用相應的 "Beats"')])]),s._v(" "),t("li",[t("p",[s._v("NGINX(非Elastic stack)")]),s._v(" "),t("p",[s._v("一個非同步框架的網頁伺服器，非 Elastic stack 只是這邊Demo架構需要一個資料提供者較容易展示結果，這裡會將 NGINX 中的 Log 藉由 FileBeat 傳送至 Logstash，之後將持久化至 Elasticsearch 並由 Kibana 來展示數據")])])]),s._v(" "),t("h2",{attrs:{id:"用-docker-建置-elastic-stack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用-docker-建置-elastic-stack"}},[s._v("#")]),s._v(" 用 Docker 建置 Elastic stack")]),s._v(" "),t("p",[s._v("以下使用 Docker 來建置 Elastic stack，在搭建服務之前需要先創建一個 docker network，之後建置的服務都會使用這個 Network 來溝通;以 Birdge 模式創建一個名為 elknetwork 的 Docker network")]),s._v(" "),t("p",[t("code",[s._v("docker network create elknetwork")])]),s._v(" "),t("p",[s._v('接下來我們一次把需要的 Image 都拉取下來，一個沉重的建議，在同一個應用下，版本號"盡量全部統一"，官方的倉庫走這邊 '),t("a",{attrs:{href:"https://www.docker.elastic.co/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.docker.elastic.co/"),t("OutboundLink")],1),s._v("，要從 Docker hub 上拉取也是可以")]),s._v(" "),t("ul",[t("li",[s._v("Elasticsearch : "),t("code",[s._v("docker pull docker.elastic.co/elasticsearch/elasticsearch:7.17.4")])]),s._v(" "),t("li",[s._v("Kibana : "),t("code",[s._v("docker pull docker.elastic.co/kibana/kibana:7.17.4")])]),s._v(" "),t("li",[s._v("Logstash : "),t("code",[s._v("docker pull docker.elastic.co/logstash/logstash:7.17.4")])]),s._v(" "),t("li",[s._v("Filebeat : "),t("code",[s._v("docker pull docker.elastic.co/beats/filebeat:7.17.4")])]),s._v(" "),t("li",[s._v("NGINX(直接抓最新版本) : "),t("code",[s._v("docker pull nginx")])])]),s._v(" "),t("p",[s._v("拉取成功的話長這樣")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("DockerHub"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("ELK"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("docker images\nREPOSITORY                                      TAG       IMAGE ID       CREATED       SIZE\nnginx                                           latest    0e901e68141f   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" weeks ago   142MB\ndocker.elastic.co/elasticsearch/elasticsearch   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.17")]),s._v(".4    d64cccab426e   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" weeks ago   630MB\ndocker.elastic.co/beats/filebeat                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.17")]),s._v(".4    7675b1be93e0   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" weeks ago   280MB\ndocker.elastic.co/logstash/logstash             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.17")]),s._v(".4    93aa11296788   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" weeks ago   798MB\ndocker.elastic.co/kibana/kibana                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.17")]),s._v(".4    86967a98433b   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" weeks ago   821MB\n")])])]),t("p",[s._v("方丈為人比較小心眼，先各自啟動看看是不是能正常運作，再來編寫 Docker Compose 文件處理持久化跟設定，直接下 "),t("code",[s._v("docker run")]),s._v(" 啟動看看:")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Elasticsearch :")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("先以單節點模式啟動 Elasticsearch ; docker 指令")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d ^\n--name myelasticsearch ^\n--network elknetwork ^\n-p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 ^\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" ^\ndocker.elastic.co/elasticsearch/elasticsearch:7.17.4\n")])])])]),s._v(" "),t("li",[t("p",[s._v("啟動後至 "),t("code",[s._v("http://localhost:9200/")]),s._v(' 察看結果，看到以下畫面就是啟動成功了"You Know, for Search"'),t("br"),s._v(" "),t("img",{attrs:{src:a(469),alt:"elasticsearch_host"}})])])])]),s._v(" "),t("li",[t("p",[s._v("Kibana")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("以上面啟動的 Elasticsearch 為 Host 啟動 Kibana; 兩個要點注意--network是否橋接到同一個網路介面，"),t("code",[s._v("ELASTICSEARCH_HOSTS=http://myelasticsearch:9200")]),s._v(" 以當下的創建的 elasticsearch 服務為準")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d ^\n--name mykibana ^\n--network elknetwork ^\n-p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v(":5601 ^\n-e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ELASTICSEARCH_HOSTS=http://myelasticsearch:9200"')]),s._v(" ^\ndocker.elastic.co/kibana/kibana:7.17.4\n")])])])]),s._v(" "),t("li",[t("p",[s._v("啟動後至 "),t("code",[s._v("http://localhost:5601/")]),s._v(" 察看結果，若啟動成功會看到以下介面"),t("br"),s._v(" "),t("img",{attrs:{src:a(470),alt:"kibana_host"}})])])])]),s._v(" "),t("li",[t("p",[s._v("Logstash")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("啟動 Logstash 這邊會映射兩個 port 號，5044 這是 default beats port; 9600 是給 Web API 使用的")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d ^\n--name mylogstash ^\n--network elknetwork ^\n-p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5044")]),s._v(":5044 ^\n-p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9600")]),s._v(":9600 ^\ndocker.elastic.co/logstash/logstash:7.17.4\n")])])])]),s._v(" "),t("li",[t("p",[s._v("啟動後至 "),t("code",[s._v("http://localhost:9600/_node/pipelines?pretty")]),s._v(" 應該會看到一個預設的 pipelines"),t("br"),s._v(" "),t("img",{attrs:{src:a(471),alt:"logstash_host"}})])])])]),s._v(" "),t("li",[t("p",[s._v("Filebeat")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("啟動 Filebeat -strict.perms=false 不檢查配置文件 es.yml")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d ^\n--name myfilebeat ^\n--network elknetwork ^\n--user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root ^\n-e -strict.perms"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false ^\ndocker.elastic.co/beats/filebeat:7.17.4\n")])])])]),s._v(" "),t("li",[t("p",[s._v("由於沒有映射 Port 到容器外面這邊可以使用 "),t("code",[s._v("docker logs [Container]")]),s._v(" 查一下 Log 輸出\n啟動成功應該會在 Log 中看到以下字眼"),t("br"),s._v(" "),t("img",{attrs:{src:a(472),alt:"filebeat_logs"}})])])])]),s._v(" "),t("li",[t("p",[s._v("NGINX")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("毫無反應就是一個 NGINX 直接無情啟動")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d ^\n--name mynginx ^\n--network elknetwork ^\n-p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7414")]),s._v(":80 ^\nnginx\n")])])])]),s._v(" "),t("li",[t("p",[s._v("訪問 "),t("code",[s._v("http://localhost:7414/")]),s._v(" Welcome to nginx!"),t("br"),s._v(" "),t("img",{attrs:{src:a(473),alt:"NGINX_host"}})])])])]),s._v(" "),t("li",[t("p",[s._v("小結")]),s._v(" "),t("p",[s._v("全部啟動後檢查一下結果 Docker 中會有5個容器，以下的都用不到...; 接下編寫 Docker Compose 用於啟動一個簡單的 Elastic Stack ; 我們需要額外設定的東西主要有兩項:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("C:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Users"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mobet"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n CONTAINER ID   IMAGE                                                  COMMAND                  CREATED          STATUS          PORTS                                            NAMES\n 0e09f4cb368c   nginx                                                  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" minutes ago    Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" minutes    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:7414-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp                             mynginx\n 9f4dfcaa3db0   docker.elastic.co/kibana/kibana:7.17.4                 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/tini -- /usr/l…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" minutes ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" minutes   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:5601-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v("/tcp                           mykibana\n a76d14ccd71d   docker.elastic.co/beats/filebeat:7.17.4                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/tini -- /u…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" minutes ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" minutes                                                    myfilebeat\n 90789d97e6bc   docker.elastic.co/logstash/logstash:7.17.4             "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/bin/dock…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" minutes ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" minutes   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:5044-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5044")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9600-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9600")]),s._v("/tcp   mylogstash\n ab772cb2f745   docker.elastic.co/elasticsearch/elasticsearch:7.17.4   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/tini -- /usr/l…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v(" minutes ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v(" minutes   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9200-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v("/tcp                 myelasticsearch\n")])])]),t("ul",[t("li",[s._v("將 Elastic Stack 中必要的資料持久化至硬碟(windows 環境下直接用 docker 指令做 bind mounts 真得太過陰間...)")]),s._v(" "),t("li",[s._v("將 Elastic Stack 需要使用的設定檔 Bind 到指定的實體位置，方便修改")]),s._v(" "),t("li",[s._v("添加一些更詳細的設定")]),s._v(" "),t("li",[s._v("下章節用 Docker Compose 來建置環境")])])])])])}),[],!1,null,null,null);e.default=r.exports}}]);