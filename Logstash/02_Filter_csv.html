<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Logstash åŒ¯å‡º CSV | æˆ‘çš„ Elastic Stack ç­†è¨˜</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="å·²ç¶“åˆ°äº†ä¸è¨˜ä¸‹ä¾†å°±æœƒå¿˜è¨˜çš„å¹´ç´€äº†ï¼Œç´€éŒ„ä¸€ä¸‹è‡ªèº«å­¸ç¿’ Elasticsearch;Logstash;Kibana;Beats çš„ä¸€äº›æ­·ç¨‹">
    
    <link rel="preload" href="/BookELK/assets/css/0.styles.d96730b3.css" as="style"><link rel="preload" href="/BookELK/assets/js/app.eccb4e14.js" as="script"><link rel="preload" href="/BookELK/assets/js/2.6319aacc.js" as="script"><link rel="preload" href="/BookELK/assets/js/6.67ab2b88.js" as="script"><link rel="prefetch" href="/BookELK/assets/js/10.a870efe4.js"><link rel="prefetch" href="/BookELK/assets/js/11.1bf0ef2c.js"><link rel="prefetch" href="/BookELK/assets/js/12.26ef642a.js"><link rel="prefetch" href="/BookELK/assets/js/13.32f0189e.js"><link rel="prefetch" href="/BookELK/assets/js/14.e15f0edf.js"><link rel="prefetch" href="/BookELK/assets/js/15.75eba30d.js"><link rel="prefetch" href="/BookELK/assets/js/16.61622831.js"><link rel="prefetch" href="/BookELK/assets/js/17.36ad0752.js"><link rel="prefetch" href="/BookELK/assets/js/18.12297b0c.js"><link rel="prefetch" href="/BookELK/assets/js/19.ed2f083d.js"><link rel="prefetch" href="/BookELK/assets/js/20.3023fff0.js"><link rel="prefetch" href="/BookELK/assets/js/21.479d1e86.js"><link rel="prefetch" href="/BookELK/assets/js/22.a6b074b8.js"><link rel="prefetch" href="/BookELK/assets/js/23.85f62943.js"><link rel="prefetch" href="/BookELK/assets/js/24.b152d338.js"><link rel="prefetch" href="/BookELK/assets/js/25.3d08c2ca.js"><link rel="prefetch" href="/BookELK/assets/js/26.482be533.js"><link rel="prefetch" href="/BookELK/assets/js/27.f78275e0.js"><link rel="prefetch" href="/BookELK/assets/js/28.0c971abe.js"><link rel="prefetch" href="/BookELK/assets/js/29.07505f8d.js"><link rel="prefetch" href="/BookELK/assets/js/3.6d77eb43.js"><link rel="prefetch" href="/BookELK/assets/js/30.75b6a2e6.js"><link rel="prefetch" href="/BookELK/assets/js/31.d14f8f00.js"><link rel="prefetch" href="/BookELK/assets/js/32.4b2e25c5.js"><link rel="prefetch" href="/BookELK/assets/js/4.509066ce.js"><link rel="prefetch" href="/BookELK/assets/js/5.a7dd103d.js"><link rel="prefetch" href="/BookELK/assets/js/7.cde76e12.js"><link rel="prefetch" href="/BookELK/assets/js/8.9bb44987.js"><link rel="prefetch" href="/BookELK/assets/js/9.c48b5107.js">
    <link rel="stylesheet" href="/BookELK/assets/css/0.styles.d96730b3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/BookELK/" class="home-link router-link-active"><!----> <span class="site-name">æˆ‘çš„ Elastic Stack ç­†è¨˜</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>kibana</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Logstash</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BookELK/Logstash/02_Filter_csv.html" aria-current="page" class="active sidebar-link">Filter csv</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#äº‹å‰æº–å‚™å·¥ä½œ" class="sidebar-link">äº‹å‰æº–å‚™å·¥ä½œ</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#pipeline" class="sidebar-link">Pipeline</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#pm25csv-conf" class="sidebar-link">pm25csv.conf</a></li></ul></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#åŒ¯å…¥è³‡æ–™" class="sidebar-link">åŒ¯å…¥è³‡æ–™</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#å¯¦ç”¨æŒ‡ä»¤" class="sidebar-link">å¯¦ç”¨æŒ‡ä»¤</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#å•Ÿå‹•-logstash-åŒ¯å…¥è³‡æ–™" class="sidebar-link">å•Ÿå‹• Logstash åŒ¯å…¥è³‡æ–™</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#kibana-æŸ¥çœ‹çµæœ" class="sidebar-link">Kibana æŸ¥çœ‹çµæœ</a></li></ul></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#mutate-filter-plugin" class="sidebar-link">Mutate filter plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#å¼•å…¥-mutate" class="sidebar-link">å¼•å…¥ mutate</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#æœ€çµ‚æˆæœ" class="sidebar-link">æœ€çµ‚æˆæœ</a></li></ul></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#è£œå……" class="sidebar-link">è£œå……</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#stdin" class="sidebar-link">Stdin</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#csv-æ–°è³‡æ–™" class="sidebar-link">CSV æ–°è³‡æ–™</a></li><li class="sidebar-sub-header"><a href="/BookELK/Logstash/02_Filter_csv.html#é‡æ–°è¼‰å…¥" class="sidebar-link">é‡æ–°è¼‰å…¥</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Beats</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Demo</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Elastic stack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="logstash-åŒ¯å‡º-csv"><a href="#logstash-åŒ¯å‡º-csv" class="header-anchor">#</a> Logstash åŒ¯å‡º CSV</h1> <p>Logstash æ“…é•·å°‡å„å¼çš„è³‡æ–™å€’å…¥ Elasticsearch ä¸­ï¼Œæ­¤ç¯‡è¨˜éŒ„ä¸€ä¸‹ä½¿ç”¨ Logstash å°‡ CSV ä¸­çš„è³‡æ–™åŒ¯å…¥ elasticsearch ä¸­çš„éç¨‹</p> <p>ğŸ“˜ Reference</p> <ul><li><a href="https://www.elastic.co/guide/en/logstash/current/index.html" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡ä»¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">kaggle æ•¸æ“šå»ºæ¨¡å’Œæ•¸æ“šåˆ†æå¹³å°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-mutate.html#plugins-filters-mutate-convert" target="_blank" rel="noopener noreferrer">Mutate filter plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-csv.html" target="_blank" rel="noopener noreferrer">Csv filter plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="äº‹å‰æº–å‚™å·¥ä½œ"><a href="#äº‹å‰æº–å‚™å·¥ä½œ" class="header-anchor">#</a> äº‹å‰æº–å‚™å·¥ä½œ</h2> <ul><li>å…ˆä¸‹è¼‰ Logstash æœ¬æ–‡ä½¿ç”¨ç‰ˆæœ¬ logstash-7.17.1-windows ç‰ˆæœ¬</li> <li>æ‰¾åˆ°ä¸€ä»½ CSV æ ¼å¼çš„è³‡æ–™ï¼Œä»¥<code>,</code>åˆ†éš”è³‡æ–™ï¼Œä¸¦æœ‰å®Œæ•´æ–·è¡Œ</li> <li>è§£å£“ç¸®å¾Œå…§å®¹å¦‚ä¸‹:<br> <img src="/BookELK/assets/img/LogstashPipelinefolder.c7dd69a0.png" alt="logstashè³‡æ–™å¤¾"></li> <li>åœ¨è³‡æ–™å¤¾åº•ä¸‹æ–°å¢ä¸€å€‹ <code>pipeline</code> çš„è³‡æ–™å¤¾ä¹‹å¾Œç”¨ä¾†å­˜æ”¾ pipeline è¨­å®šæª”</li> <li>ä»¥ä¸‹ç‚ºæœ¬æ–‡æ¸¬è©¦è³‡æ–™ä¾†è‡³ Opendata pm2.5 csv è³‡æ–™é›†çµæ§‹å¦‚ä¸‹:<br> <img src="/BookELK/assets/img/pm25test.f402b3ca.png" alt="æ¸¬è©¦è³‡æ–™"></li></ul> <h2 id="pipeline"><a href="#pipeline" class="header-anchor">#</a> Pipeline</h2> <p>æº–å‚™å¥½ä¹‹å¾Œä¾†ç·¨å¯«ç¬¬ä¸€å€‹ pipeline</p> <h3 id="pm25csv-conf"><a href="#pm25csv-conf" class="header-anchor">#</a> pm25csv.conf</h3> <p>åœ¨ <code>pipeline</code> é€™å€‹è³‡æ–™å¤¾åº•ä¸‹æ–°å¢ä¸€å€‹ pm25csv.conf æ–‡ä»¶ï¼Œæ–‡ä»¶å…§å®¹å¦‚ä¸‹:</p> <div class="language-JSON extra-class"><pre class="language-json"><code>input <span class="token punctuation">{</span>
    file <span class="token punctuation">{</span>
        path =&gt; <span class="token string">&quot;D:/DockerHub/Ref/Data/OpenData/pm25.csv&quot;</span>
        start_position =&gt; <span class="token string">&quot;beginning&quot;</span>
        sincedb_path=&gt;<span class="token string">&quot;D:/DockerHub/Ref/Data/OpenData/pm25.log&quot;</span>
    <span class="token punctuation">}</span>
    stdin <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
filter <span class="token punctuation">{</span>
    csv <span class="token punctuation">{</span>
        skip_header =&gt; <span class="token boolean">true</span>
        separator =&gt; <span class="token string">&quot;,&quot;</span>
        columns =&gt; <span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;device&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;town&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;types&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lat&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lon&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;temp&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hum&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;pm25&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
output <span class="token punctuation">{</span>
    elasticsearch <span class="token punctuation">{</span> 
        hosts =&gt; <span class="token punctuation">[</span><span class="token string">&quot;http://localhost:9200/&quot;</span><span class="token punctuation">]</span>
        index =&gt; <span class="token string">&quot;pm25-v1&quot;</span>
    <span class="token punctuation">}</span>
    stdout <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>Logstash Pipline çš„ä¸‰å¤§è¦ç´ åˆ†åˆ¥æ˜¯ input; filter; output</p></li> <li><p><code>Input</code> : æˆ‘å€‘æŒ‡å®šå…©å€‹ è³‡æ–™ä¾†æºä¸€å€‹æ˜¯ file ; å¦ä¸€å€‹æ˜¯ stdin</p> <ul><li><code>input stdin</code> ç”¨ä¾†æ¸¬è©¦ç”¨çš„ï¼Œä¸‹é¢æœƒç¤ºç¯„æ€éº¼ç”¨</li> <li><code>input file path</code> è³‡æ–™ä¾†æºè·¯å¾‘</li> <li><code>input file start_position</code> å¾ç”šéº¼ä½ç½®é–‹å§‹è®€å–æ–‡ä»¶ï¼ŒLogstashé è¨­æ˜¯çµæŸä½ç½®ï¼Œå°±æ˜¯æ¯æ¬¡éƒ½æ‹¿æœ€å¾Œä¸€ç­†ï¼Œé€™ç¨®é è¨­çš„æ¨¡å¼é©åˆç”¨åœ¨è®€ log çš„ç’° å¢ƒï¼Œå› ç‚ºè‹¥æ˜¯ log çš„è©±æ¯æ¬¡ä¸€ç­†æ–°çš„æ—¥èªŒç¸½æ˜¯æœƒæ·»åŠ åœ¨æ–‡ä»¶æœ€å¾Œã€‚è€Œé€™é‚Šæˆ‘å€‘å°å…¥çš„æ˜¯æ•´å€‹ csv æ–‡ä»¶æ‰€ä»¥è®“ Logstash å¾é ­é–‹å§‹è®€å–è¨­å®šç‚º <code>beginning</code> ç•¶è®€å–åˆ°æœ€æœ«æ™‚ï¼ŒLogstash å°‡è‡ªå‹•åˆ‡æ›ç‚ºé è¨­æ¨¡å¼ <code>End</code> è®€å–æœ€å¾Œä¸€ç­†</li> <li><code>input file sincedb_path</code> æŒ‡å®šä¸€å€‹ logï¼Œé€™å€‹ log æä¾› Logstash <code>æ¢é‡</code> ç´€éŒ„æœ€å¾Œä¸€ç­†è®€å–è³‡æ–™çš„åç§»é‡ï¼Œè‹¥ä¸æŒ‡å®šæœƒè‡ªå‹•ç”¢ç”Ÿï¼Œè‹¥ä¸æƒ³ç´€éŒ„è«‹è¨­ç‚º <code>null</code>ï¼Œç‚ºäº†æ–¹ä¾¿ç®¡ç†å¤§å¤šæ™‚å€™å»ºè­°é‚„æ˜¯ç´€éŒ„ä¸€ä¸‹</li></ul></li> <li><p><code>filter</code> : é€™é‚Šä½¿ç”¨ <code>Csv filter plugin</code> ä¾†åšè³‡æ–™è™•ç†ï¼Œæ–‡ä»¶è«‹è¦‹ç½®é ‚ Reference</p> <ul><li><code>filter csv skip_header</code> æŒ‡å®šè·³éæ¨™é ­</li> <li><code>filter csv separator</code> è¨­å®šç‚º <code>&quot;,&quot;</code> ä»¥é€—è™Ÿæ¨™ç¤ºè³‡æ–™é–“éš”</li> <li><code>filter csv columns</code> æ¯å€‹æ¬„ä½è³‡æ–™å¦‚ä½•è§£æé€² Elasticsearch</li></ul></li> <li><p><code>output</code> : ä¸»è¦è¼¸å‡ºè³‡æ–™çš„ç›®çš„åœ° Stdout and Elasticsearchï¼Œä½¿ç”¨ <code>Elasticsearch output plugin</code>ï¼Œé‚„æœ‰è¨±å¤šä¸åŒçš„ plugin å¯ä»¥è¼¸å‡ºè³‡æ–™åˆ°å…¶ä»–çš„è¼‰é«”</p> <ul><li><code>output elasticsearch hosts</code> é è¨ˆè¼¸å‡ºç›®æ¨™çš„ elasticsearch hosts</li> <li><code>output elasticsearch index</code> é è¨ˆè¼¸å‡ºåˆ°å“ªå€‹ index ä¸‹</li> <li><code>output stdout</code> ç”¨ä¾†æ¸¬è©¦ç”¨çš„ï¼Œä¸‹é¢æœƒç¤ºç¯„æ€éº¼ç”¨</li></ul></li></ul> <p>âš ï¸ é€™è£¡å¾ˆé‡è¦ å¦‚æœåœ¨ windows ç’°å¢ƒä¸‹ <code>path =&gt; &quot;D:/DockerHub/Ref/Data/OpenData/pm25.csv&quot;</code> è·¯å¾‘çš„æ­£åæ–œç·šè«‹æ³¨æ„<br>
â€ƒâ€ƒâ€ƒ=&gt; é€™æ˜¯ windows è¼¸å‡ºçš„è·¯å¾‘ <code>D:\DockerHub\Ref\Data\OpenData\pm25.csv</code> (é€™æ˜¯éŒ¯çš„)<br>
â€ƒâ€ƒâ€ƒ=&gt; é€™æ˜¯ logstash ä¸­ç´„å®šçš„è·¯å¾‘ <code>D:/DockerHub/Ref/Data/OpenData/pm25.csv</code> (é€™æ˜¯å°çš„)<br>
â€ƒâ€ƒâ€ƒ=&gt; ä¸‹é¢é‚£å€‹æ‰å¯ä»¥æˆåŠŸé‹ä½œ</p> <h2 id="åŒ¯å…¥è³‡æ–™"><a href="#åŒ¯å…¥è³‡æ–™" class="header-anchor">#</a> åŒ¯å…¥è³‡æ–™</h2> <h3 id="å¯¦ç”¨æŒ‡ä»¤"><a href="#å¯¦ç”¨æŒ‡ä»¤" class="header-anchor">#</a> å¯¦ç”¨æŒ‡ä»¤</h3> <ul><li><p>ç›¸é—œçš„æŒ‡ä»¤é›†éƒ½åœ¨ <code>bin</code> è£¡é¢å¯ä»¥ç›´æ¥å‘¼å«ï¼Œæª¢è¦– Logstash ä¸­çš„ plugin</p> <div class="language-sh extra-class"><pre class="language-sh"><code>.<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>logstash-plugin list
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code>  logstash-codec-avro
  logstash-codec-cef
  logstash-codec-collectd
  logstash-codec-dots
  logstash-codec-edn
  logstash-codec-edn_lines
  logstash-codec-es_bulk
  logstash-codec-fluent
  <span class="token punctuation">..</span>.ä¸‹ç•¥
</code></pre></div><p><img src="/BookELK/assets/img/pluginlist.be1114c6.png" alt="logstashpluginlist"></p></li> <li><p>ç¢ºå®šä½¿ç”¨åˆ° plugin éƒ½å·²ç¶“åœ¨åˆ—è¡¨è£¡é¢ï¼Œå¦‚ä¸‹</p> <ul><li>logstash-input-stdin</li> <li>logstash-input-file</li> <li>logstash-filter-csv</li> <li>logstash-output-elasticsearch</li> <li>logstash-output-stdout
å¦‚æœæœ‰ç¼ºï¼Œåˆ°å®˜æ–¹å»ä¸‹è¼‰ç›¸å°æ‡‰ç‰ˆæœ¬çš„ pluginï¼Œä½†åŸºæœ¬ä¸Šæ‡‰è©²éƒ½æœƒæœ‰</li></ul></li></ul> <h3 id="å•Ÿå‹•-logstash-åŒ¯å…¥è³‡æ–™"><a href="#å•Ÿå‹•-logstash-åŒ¯å…¥è³‡æ–™" class="header-anchor">#</a> å•Ÿå‹• Logstash åŒ¯å…¥è³‡æ–™</h3> <p>ä½¿ç”¨æŒ‡ä»¤å•Ÿå‹• Logstashï¼Œ-f å¾Œé¢æŒ‡å®šç·¨å¯«å¥½çš„ pipeline config (é‚„æœ‰ä¸€å€‹æ–¹æ³•æ˜¯ç”¨ pipeline.yml ä¸­ï¼Œä½¿ç”¨æ–¹æ³•é è¨ˆä¹Ÿæœƒæœ‰ä¸€ç¯‡ç­†è¨˜)</p> <div class="language-sh extra-class"><pre class="language-sh"><code>  .<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>logstash -f .<span class="token punctuation">\</span>pipeline<span class="token punctuation">\</span>pm25csv.conf
</code></pre></div><p>è‹¥æ˜¯å•Ÿå‹•æˆåŠŸæ‡‰è©²æœƒçœ‹åˆ°è³‡æ–™ä¸€ç­†ä¸€ç­†çš„é¡¯ç¤ºåœ¨ terminal ä¸Šé¢ï¼Œé‚£æ˜¯å› ç‚º pipeline <code>output stdout</code> é€™å€‹å°±æ˜¯å°‡è¼¸å‡ºä¸€ä½µé¡¯ç¤ºåœ¨ terminal ä¸Š</p> <p><img src="/BookELK/assets/img/terminalresult.dec75601.png" alt="logstashpluginlist"></p> <h3 id="kibana-æŸ¥çœ‹çµæœ"><a href="#kibana-æŸ¥çœ‹çµæœ" class="header-anchor">#</a> Kibana æŸ¥çœ‹çµæœ</h3> <p>ä½¿ç”¨ GET Index search æŸ¥çœ‹</p> <div class="language-JSON extra-class"><pre class="language-json"><code> GET pm25-v1/_search
</code></pre></div><p>å¯ä»¥çœ‹åˆ° pm25-v1 é€™å€‹ index ä¸­å·²ç¶“æœ‰ 1338 ç­†è³‡æ–™</p> <p><img src="/BookELK/assets/img/kibanaresult.8d49c7ae.png" alt="kibanaresult"></p> <h2 id="mutate-filter-plugin"><a href="#mutate-filter-plugin" class="header-anchor">#</a> Mutate filter plugin</h2> <p>é›–ç„¶è³‡æ–™å·²ç¶“åŒ¯å…¥æˆåŠŸäº†ï¼Œä½†ä»”ç´°è§€å¯Ÿçš„è©±æœƒç™¼ç¾æœ‰äº›å•é¡Œï¼Œç”¨ mapping æŒ‡å®šä¾†æŸ¥çœ‹ index mappingï¼Œæœƒç™¼ç¾ &quot;temp&quot;,&quot;hum&quot;,&quot;pm25&quot; é€™å¹¾å€‹æ¬„ä½æ˜¯ text ï¼Œåœ¨ä¸€èˆ¬çš„æ‡‰ç”¨æˆ‘å€‘æ›´å¤šæ™‚å€™å¸Œæœ›é€™å¹¾å€‹æ¬„ä½æ˜¯ä»¥æ•¸å€¼æ–¹å¼å»å°æ‡‰ï¼Œæ‰€ä»¥æˆ‘å€‘è¦ä¿®æ”¹ä¸€ä¸‹ pipeline</p> <p><img src="/BookELK/assets/img/importcsvProblem.711c6968.png" alt="kibanaresult"></p> <p>å°æ‡‰çš„æ–¹æ³•å…¶å¯¦é‚„æœ‰ä¸€ç¨®æ˜¯ä¸€é–‹å§‹å°±å…ˆè¨­å®šå¥½ index èˆ‡ index mappingï¼Œé€™æ¨£ä½¿ç”¨ Logstash æ™‚åªè¦å°‡è³‡æ–™å°å…¥å³å¯ï¼Œä¸éé€™é‚Šå˜—è©¦ä¸€ä¸‹ä¸ç”¨äº‹å…ˆå»å»ºç«‹ mapping çš„æ–¹æ³•ï¼Œæˆ‘å€‘ä½¿ç”¨ mutate plugin ä¾†è™•ç†ï¼Œè©³ç´°æ–‡ä»¶è¦‹ç½®é ‚( mutate æ“ä½œå½ˆæ€§æ»¿å¤§çš„)</p> <p>mutate plugin æä¾›äº†å¹¾ç¨®è³‡æ–™å‹æ…‹å°æ‡‰ integer;integer_eu;float;float_eu;string;booleanï¼Œåªè¦åœ¨ <code>filter</code> ä¸­å¼•å…¥ <code>mutate plugin</code></p> <h3 id="å¼•å…¥-mutate"><a href="#å¼•å…¥-mutate" class="header-anchor">#</a> å¼•å…¥ mutate</h3> <p><code>filter mutate convert</code> æ¬„ä½ =&gt; æŒ‡å®šå‹åˆ¥ï¼Œå°±å¯ä»¥å°‡æ•¸å€¼è½‰å‹ï¼Œæœ€å¾Œè¨­å®šæª”å¦‚ä¸‹</p> <div class="language-JSON extra-class"><pre class="language-json"><code>    input <span class="token punctuation">{</span>
        file <span class="token punctuation">{</span>
            path =&gt; <span class="token string">&quot;D:/DockerHub/Ref/Data/OpenData/pm25.csv&quot;</span>
            start_position =&gt; <span class="token string">&quot;beginning&quot;</span>
            sincedb_path=&gt;<span class="token string">&quot;D:/DockerHub/Ref/Data/OpenData/pm25.log&quot;</span>
        <span class="token punctuation">}</span>
        stdin <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    filter <span class="token punctuation">{</span>
        csv <span class="token punctuation">{</span>
            skip_header =&gt; <span class="token boolean">true</span>
            separator =&gt; <span class="token string">&quot;,&quot;</span>
            columns =&gt; <span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;device&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;town&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;types&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lat&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lon&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;temp&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hum&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;pm25&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;time&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        mutate <span class="token punctuation">{</span>
            convert =&gt; <span class="token punctuation">{</span>
                <span class="token string">&quot;temp&quot;</span> =&gt; <span class="token string">&quot;float&quot;</span>
                <span class="token string">&quot;hum&quot;</span> =&gt; <span class="token string">&quot;float&quot;</span>
                <span class="token string">&quot;pm25&quot;</span> =&gt; <span class="token string">&quot;float&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    output <span class="token punctuation">{</span>
        elasticsearch <span class="token punctuation">{</span> 
            hosts =&gt; <span class="token punctuation">[</span><span class="token string">&quot;http://localhost:9200/&quot;</span><span class="token punctuation">]</span>
            index =&gt; <span class="token string">&quot;pm25-v1&quot;</span>
        <span class="token punctuation">}</span>
        stdout <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="æœ€çµ‚æˆæœ"><a href="#æœ€çµ‚æˆæœ" class="header-anchor">#</a> æœ€çµ‚æˆæœ</h3> <p>ä¸€æ¨£æŠŠ mapping æå–å‡ºä¾†æª¢è¦–</p> <div class="language-JSON extra-class"><pre class="language-json"><code>GET pm25-v1/_mapping/field/hum<span class="token punctuation">,</span>temp<span class="token punctuation">,</span>pm25
</code></pre></div><p>å¯ä»¥çœ‹åˆ° hum,temp,pm25 é€™ä¸‰å€‹ field éƒ½å·²ç¶“æ˜¯ <code>&quot;type&quot; : &quot;float&quot;</code></p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;pm25-v1&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;mappings&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;hum&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;full_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;hum&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;mapping&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;hum&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;float&quot;</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;temp&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;full_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;temp&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;mapping&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;temp&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;float&quot;</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;pm25&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;full_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;pm25&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;mapping&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                  <span class="token property">&quot;pm25&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                      <span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;float&quot;</span>
                  <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="è£œå……"><a href="#è£œå……" class="header-anchor">#</a> è£œå……</h2> <h3 id="stdin"><a href="#stdin" class="header-anchor">#</a> Stdin</h3> <p>åŸºæœ¬ä¸Šé€™å€‹ä¹Ÿå¯ä»¥ä¸ç”¨åŠ ï¼Œä¸éåŠ äº†å¯ä»¥ç”¨ä¾†åµéŒ¯ï¼Œé€™å€‹å¯ä»¥è®“ terminal æ¥æ”¶è¼¸å…¥ï¼Œä¾‹å¦‚è¼¸å…¥ Hello worldï¼Œå°±æœƒæ’å…¥ä¸€ç­† Hello world è³‡æ–™åˆ°æŒ‡å®šçš„ index ä¸­
<img src="/BookELK/assets/img/hellowolrd.aed53ab2.png" alt="kibanaresult"></p> <h3 id="csv-æ–°è³‡æ–™"><a href="#csv-æ–°è³‡æ–™" class="header-anchor">#</a> CSV æ–°è³‡æ–™</h3> <p>å¦‚æœå¾€ CSV è£¡é¢æ–°å¢è³‡æ–™çš„è©±ï¼Œæ¢é‡æœƒç¹¼çºŒç§»å‹•ä¸¦å°‡è³‡æ–™è‡ªå‹•æ¨é€åˆ° elasticsearch ä¸­ï¼Œå¢åŠ ä¸€ç­†æ¸¬è©¦
<img src="/BookELK/assets/img/csvnewrow.82cbdeb0.png" alt="kibanaresult"></p> <h3 id="é‡æ–°è¼‰å…¥"><a href="#é‡æ–°è¼‰å…¥" class="header-anchor">#</a> é‡æ–°è¼‰å…¥</h3> <p>è‹¥è¦é‡æ–°è¼‰å…¥è¦å°‡æŒ‡é‡æ­¸é›¶ï¼Œæˆ–æ˜¯æŠŠ .log ç›´æ¥åˆªé™¤</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/BookELK/Elasticsearch/03_Cat.html" class="prev">
        Cat
      </a></span> <span class="next"><a href="/BookELK/Beats/BeatsIntro.html">
        Beats Introduction
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/BookELK/assets/js/app.eccb4e14.js" defer></script><script src="/BookELK/assets/js/2.6319aacc.js" defer></script><script src="/BookELK/assets/js/6.67ab2b88.js" defer></script>
  </body>
</html>
