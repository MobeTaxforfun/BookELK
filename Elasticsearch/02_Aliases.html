<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elasticsearch Aliases | 我的 Elastic Stack 筆記</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="已經到了不記下來就會忘記的年紀了，紀錄一下自身學習 Elasticsearch;Logstash;Kibana;Beats 的一些歷程">
    
    <link rel="preload" href="/BookELK/assets/css/0.styles.d96730b3.css" as="style"><link rel="preload" href="/BookELK/assets/js/app.3914c4a0.js" as="script"><link rel="preload" href="/BookELK/assets/js/2.b5c8828b.js" as="script"><link rel="preload" href="/BookELK/assets/js/7.51fcc859.js" as="script"><link rel="prefetch" href="/BookELK/assets/js/10.74f390ef.js"><link rel="prefetch" href="/BookELK/assets/js/11.efca09d6.js"><link rel="prefetch" href="/BookELK/assets/js/12.41333e35.js"><link rel="prefetch" href="/BookELK/assets/js/13.fd1b8110.js"><link rel="prefetch" href="/BookELK/assets/js/14.13ab1a3c.js"><link rel="prefetch" href="/BookELK/assets/js/15.1616c71e.js"><link rel="prefetch" href="/BookELK/assets/js/16.b099b66f.js"><link rel="prefetch" href="/BookELK/assets/js/17.904e9607.js"><link rel="prefetch" href="/BookELK/assets/js/18.18b82d06.js"><link rel="prefetch" href="/BookELK/assets/js/19.f1f8ae2b.js"><link rel="prefetch" href="/BookELK/assets/js/20.99f69658.js"><link rel="prefetch" href="/BookELK/assets/js/21.7bff5f59.js"><link rel="prefetch" href="/BookELK/assets/js/22.37f4af6a.js"><link rel="prefetch" href="/BookELK/assets/js/23.37ce2d28.js"><link rel="prefetch" href="/BookELK/assets/js/24.d9093d4b.js"><link rel="prefetch" href="/BookELK/assets/js/25.551d0a0f.js"><link rel="prefetch" href="/BookELK/assets/js/26.1edbfc3d.js"><link rel="prefetch" href="/BookELK/assets/js/27.a749efbc.js"><link rel="prefetch" href="/BookELK/assets/js/28.c0fe1c2a.js"><link rel="prefetch" href="/BookELK/assets/js/29.a9174e5e.js"><link rel="prefetch" href="/BookELK/assets/js/3.fd9eef7f.js"><link rel="prefetch" href="/BookELK/assets/js/30.be2630ef.js"><link rel="prefetch" href="/BookELK/assets/js/31.9623a64b.js"><link rel="prefetch" href="/BookELK/assets/js/32.c9c9a49a.js"><link rel="prefetch" href="/BookELK/assets/js/4.78505eef.js"><link rel="prefetch" href="/BookELK/assets/js/5.1566c8ee.js"><link rel="prefetch" href="/BookELK/assets/js/6.f928f57d.js"><link rel="prefetch" href="/BookELK/assets/js/8.6d5099b6.js"><link rel="prefetch" href="/BookELK/assets/js/9.8ea6cc7f.js">
    <link rel="stylesheet" href="/BookELK/assets/css/0.styles.d96730b3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/BookELK/" class="home-link router-link-active"><!----> <span class="site-name">我的 Elastic Stack 筆記</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Elasticsearch</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BookELK/Elasticsearch/01_Introduction.html" class="sidebar-link">ELK Stack Intro</a></li><li><a href="/BookELK/Elasticsearch/01_Elasticsearch.html" class="sidebar-link">Elasticsearch Intro</a></li><li><a href="/BookELK/Elasticsearch/02_Index.html" class="sidebar-link">Index</a></li><li><a href="/BookELK/Elasticsearch/02_Document.html" class="sidebar-link">Document</a></li><li><a href="/BookELK/Elasticsearch/02_Mapping.html" class="sidebar-link">Mapping</a></li><li><a href="/BookELK/Elasticsearch/02_Aliases.html" aria-current="page" class="active sidebar-link">Index Aliases</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#index-alias-的使用情境" class="sidebar-link">Index Alias 的使用情境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#用貓列出所有的-alias" class="sidebar-link">用貓列出所有的 Alias</a></li></ul></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#新增、更新-index-alias" class="sidebar-link">新增、更新 Index Alias</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#查詢-alias" class="sidebar-link">查詢 alias</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#刪除-alias" class="sidebar-link">刪除 alias</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#aliases-api-類似檢視表用法" class="sidebar-link">Aliases API (類似檢視表用法)</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticsearch/02_Aliases.html#aliases-api-reindex" class="sidebar-link">Aliases API (Reindex)</a></li></ul></li><li><a href="/BookELK/Elasticsearch/02_Analyzer.html" class="sidebar-link">Analyzer</a></li><li><a href="/BookELK/Elasticsearch/02_AnalyzerCh.html" class="sidebar-link">Analyzer 中文分詞</a></li><li><a href="/BookELK/Elasticsearch/02_SearchAPI.html" class="sidebar-link">Search API</a></li><li><a href="/BookELK/Elasticsearch/02_Query.html" class="sidebar-link">Query DSL</a></li><li><a href="/BookELK/Elasticsearch/02_Aggregations.html" class="sidebar-link">Aggregations</a></li><li><a href="/BookELK/Elasticsearch/03_Cat.html" class="sidebar-link">Cat</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>kibana</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Logstash</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Beats</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Demo</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Elastic stack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="elasticsearch-aliases"><a href="#elasticsearch-aliases" class="header-anchor">#</a> Elasticsearch Aliases</h1> <p>本章紀錄 Elasticsearch Aliases (別名)，以下為官方文件靈魂說明，基本上靈力值太低的我根本看不懂...</p> <blockquote><p>An alias is a secondary name for a group of data streams or indices. Most Elasticsearch APIs accept an alias in place of a data stream or index name.</p> <p>You can change the data streams or indices of an alias at any time. If you use aliases in your application’s Elasticsearch requests, you can reindex data with no downtime or changes to your app’s code.</p></blockquote> <p>為什麼要對索引使用 Alias，自身理解</p> <ul><li>靈活性</li> <li>方便修改 Mapping</li> <li>如同關聯型資料庫中的 View 表</li></ul> <p>⭐️ 以下打一百個星號 ⭐️ * 100</p> <p>在 elasticsearch 中別名有兩種，<strong>在查資料的時候先確定文章是在說哪種 alias</strong>，這一篇是紀錄  index alias，在官方文件中</p> <ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/aliases.html" target="_blank" rel="noopener noreferrer">Aliases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 這是給 data stream alias 和  index alias 用的</li> <li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/field-alias.html" target="_blank" rel="noopener noreferrer">Alias field type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 這是給 field 用的，是一種 field type</li></ul> <p>📘 Reference</p> <ul><li>官方文件；<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/aliases.html" target="_blank" rel="noopener noreferrer">走這裡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="index-alias-的使用情境"><a href="#index-alias-的使用情境" class="header-anchor">#</a> Index Alias 的使用情境</h2> <p>🔮 Alias Should Know</p> <ul><li>可以訂自請求範圍，如同 MySQL &amp; MSSQL View</li> <li>使用 Alias Reindex</li></ul> <p>📘 測試操作步驟</p> <ul><li>先建入 Template 資料 : Index為 bookstore 與三筆測試資料</li> <li>對 Index bookstore 增加 mybookstore alias</li> <li>對 mybookstore alias 使用 alias filter</li> <li>簡單的試一下 Reindex</li></ul> <h3 id="用貓列出所有的-alias"><a href="#用貓列出所有的-alias" class="header-anchor">#</a> 用貓列出所有的 Alias</h3> <div class="language-sh extra-class"><pre class="language-sh"><code>GET _cat/aliases?v
</code></pre></div><p><img src="/BookELK/assets/img/listedaliases.32dcd01b.png" alt="列出所有別名"></p> <h2 id="新增、更新-index-alias"><a href="#新增、更新-index-alias" class="header-anchor">#</a> 新增、更新 Index Alias</h2> <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.17/indices-add-alias.html" target="_blank" rel="noopener noreferrer">官方文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>新增與更新的方法</p> <ul><li><p><code>POST &lt;target&gt;/_alias/&lt;alias&gt;</code></p></li> <li><p><code>POST &lt;target&gt;/_aliases/&lt;alias&gt;</code></p></li> <li><p><code>PUT &lt;target&gt;/_alias/&lt;alias&gt;</code></p></li> <li><p><code>PUT &lt;target&gt;/_aliases/&lt;alias&gt;</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code>PUT bookstore/_alias/mybookstore
</code></pre></div><div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>使用 Alias 查詢 Index 來得到快樂</p> <div class="language-sh extra-class"><pre class="language-sh"><code>GET mybookstore/_search
</code></pre></div><p><img src="/BookELK/assets/img/listindexbyalias.c90b6273.png" alt="使用alias來查詢"></p></li></ul> <h2 id="查詢-alias"><a href="#查詢-alias" class="header-anchor">#</a> 查詢 alias</h2> <ul><li><p><code>GET _alias/&lt;alias&gt;</code> 拿搜尋</p></li> <li><p><code>GET _alias</code> 全部拿</p></li> <li><p><code>GET &lt;target&gt;/_alias/&lt;alias&gt;</code> 在某個Index下拿</p> <div class="language-sh extra-class"><pre class="language-sh"><code>GET bookstore/_alias/*
GET bookstore/_alias/mybookstore
</code></pre></div><p><img src="data:image/png;base64,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" alt="取得alias"></p></li></ul> <h2 id="刪除-alias"><a href="#刪除-alias" class="header-anchor">#</a> 刪除 alias</h2> <ul><li><p><code>DELETE /&lt;index&gt;/_alias/&lt;alias&gt;</code></p></li> <li><p><code>DELETE /&lt;index&gt;/_aliases/&lt;alias&gt;</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code>DELETE /bookstore/_alias/mybookstore
</code></pre></div><div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;acknowledged&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="aliases-api-類似檢視表用法"><a href="#aliases-api-類似檢視表用法" class="header-anchor">#</a> Aliases API (類似檢視表用法)</h2> <blockquote><p>Performs one or more alias actions in a single atomic operation.</p></blockquote> <p>透過原子操作來設定 Aliases，當成類似檢視表的功能只取出，只取出規格為320頁的書籍</p> <div class="language-sh extra-class"><pre class="language-sh"><code>POST _aliases
<span class="token punctuation">{</span>
    <span class="token string">&quot;actions&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;add&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bookstore&quot;</span>,
        <span class="token string">&quot;alias&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mybookstore&quot;</span>,
        <span class="token string">&quot;filter&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;match&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;publisher&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;悅知文化&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用 alias 進行搜尋</p> <div class="language-sh extra-class"><pre class="language-sh"><code>GET /mybookstore/_search
</code></pre></div><div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;hits&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;_index&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;bookstore&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;_type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;_score&quot;</span> <span class="token operator">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;_source&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;title&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;對你說的謊【博客來獨家限量贈：番外篇】&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;author&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;尾巴&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;publisher&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;悅知文化&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;publishTime&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2022-07-04&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;language&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;繁體中文&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">340</span><span class="token punctuation">,</span>
            <span class="token property">&quot;introduction&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;博客來、金石堂___青春文學暢銷作家．尾巴 全新校園揪心篇章即便此刻的我並不認識那個人，但過去我的傷痛，卻像是穿越了時空，直直地傳達給——我所遺忘的，去年的你。&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;country&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;台灣、蘭嶼、綠島、澎湖、金門、馬祖&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;ISBN&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;9789865102258&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tag&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token string">&quot;文學小說&quot;</span><span class="token punctuation">,</span>
              <span class="token string">&quot;華文創作&quot;</span><span class="token punctuation">,</span>
              <span class="token string">&quot;小說&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;spec&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;Bookbinding&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;平裝&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;page&quot;</span> <span class="token operator">:</span> <span class="token number">320</span><span class="token punctuation">,</span>
              <span class="token property">&quot;grade&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;普通級&quot;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="aliases-api-reindex"><a href="#aliases-api-reindex" class="header-anchor">#</a> Aliases API (Reindex)</h2> <p>算是 Aliases 重要的一種應用就是 Re-index，某些時候需要將 Index 重新 Mapping 或是重新指定 shards;replicas 時可以這樣做(因為 index 是不能直接更新的)</p> <ul><li>新建一個 index v2</li> <li>Reindex  index_v1 to index_v2</li> <li>把 alias 指到 index_v2</li> <li>刪除原來的 index_v1</li> <li>完成 index 的更新</li></ul> <p><img src="/BookELK/assets/img/aliasreindex.47a01f4a.png" alt="使用aliasReindex"></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/BookELK/Elasticsearch/02_Mapping.html" class="prev">
        Mapping
      </a></span> <span class="next"><a href="/BookELK/Elasticsearch/02_Analyzer.html">
        Analyzer
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/BookELK/assets/js/app.3914c4a0.js" defer></script><script src="/BookELK/assets/js/2.b5c8828b.js" defer></script><script src="/BookELK/assets/js/7.51fcc859.js" defer></script>
  </body>
</html>
