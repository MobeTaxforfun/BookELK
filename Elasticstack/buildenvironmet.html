<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elastic stack 環境建置 | 我的 Elastic Stack 筆記</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="已經到了不記下來就會忘記的年紀了，紀錄一下自身學習 Elasticsearch;Logstash;Kibana;Beats 的一些歷程">
    
    <link rel="preload" href="/BookELK/assets/css/0.styles.d96730b3.css" as="style"><link rel="preload" href="/BookELK/assets/js/app.1cd25600.js" as="script"><link rel="preload" href="/BookELK/assets/js/2.871b5155.js" as="script"><link rel="preload" href="/BookELK/assets/js/6.ae9ceff3.js" as="script"><link rel="prefetch" href="/BookELK/assets/js/10.24718fd3.js"><link rel="prefetch" href="/BookELK/assets/js/11.da6677db.js"><link rel="prefetch" href="/BookELK/assets/js/12.9d6b49d7.js"><link rel="prefetch" href="/BookELK/assets/js/13.d7b09450.js"><link rel="prefetch" href="/BookELK/assets/js/14.1a779044.js"><link rel="prefetch" href="/BookELK/assets/js/15.dd1e3836.js"><link rel="prefetch" href="/BookELK/assets/js/16.7f88bfa9.js"><link rel="prefetch" href="/BookELK/assets/js/17.5fa141ac.js"><link rel="prefetch" href="/BookELK/assets/js/18.d0c0872f.js"><link rel="prefetch" href="/BookELK/assets/js/19.be21cf65.js"><link rel="prefetch" href="/BookELK/assets/js/20.da61b3ab.js"><link rel="prefetch" href="/BookELK/assets/js/21.795002ef.js"><link rel="prefetch" href="/BookELK/assets/js/22.2ea8875f.js"><link rel="prefetch" href="/BookELK/assets/js/23.af453373.js"><link rel="prefetch" href="/BookELK/assets/js/24.bbe0a701.js"><link rel="prefetch" href="/BookELK/assets/js/25.a5a022e1.js"><link rel="prefetch" href="/BookELK/assets/js/26.b59ad89f.js"><link rel="prefetch" href="/BookELK/assets/js/27.abd29fc1.js"><link rel="prefetch" href="/BookELK/assets/js/28.5ff145c0.js"><link rel="prefetch" href="/BookELK/assets/js/29.520aeadd.js"><link rel="prefetch" href="/BookELK/assets/js/3.4369c9a6.js"><link rel="prefetch" href="/BookELK/assets/js/30.a70cd0e6.js"><link rel="prefetch" href="/BookELK/assets/js/31.13509272.js"><link rel="prefetch" href="/BookELK/assets/js/4.c1cb0972.js"><link rel="prefetch" href="/BookELK/assets/js/5.6b6e35f9.js"><link rel="prefetch" href="/BookELK/assets/js/7.ea465c4f.js"><link rel="prefetch" href="/BookELK/assets/js/8.d67be897.js"><link rel="prefetch" href="/BookELK/assets/js/9.e310f2ec.js">
    <link rel="stylesheet" href="/BookELK/assets/css/0.styles.d96730b3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/BookELK/" class="home-link router-link-active"><!----> <span class="site-name">我的 Elastic Stack 筆記</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>kibana</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Logstash</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Beats</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Demo</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Elastic stack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BookELK/Elasticstack/buildenvironmet.html" aria-current="page" class="active sidebar-link">Elastic stack 環境建置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BookELK/Elasticstack/buildenvironmet.html#行前準備" class="sidebar-link">行前準備</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticstack/buildenvironmet.html#elastic-stack-最基本架構" class="sidebar-link">Elastic stack 最基本架構</a></li><li class="sidebar-sub-header"><a href="/BookELK/Elasticstack/buildenvironmet.html#用-docker-建置-elastic-stack" class="sidebar-link">用 Docker 建置 Elastic stack</a></li></ul></li><li><a href="/BookELK/Elasticstack/buildenvwithdockercompose.html" class="sidebar-link">Elastic stack 環境建置(docker compose)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="elastic-stack-環境建置"><a href="#elastic-stack-環境建置" class="header-anchor">#</a> Elastic stack 環境建置</h1> <p>為了輕鬆玩耍 Elastic Stack 需要先準備環境，以下紀錄一下自己用 Docker 搭建 Elastic Stack 各項服務的過程</p> <p>🌏 環境</p> <ul><li>OS Windows 10</li> <li>Docker Desktop 4.9.1</li> <li>Elastic stack 各項服務已 7.17.4 為主要版本號</li> <li>Using the WSL 2 backend</li></ul> <p>🌏 想參考此篇的你須具備 Docker 與編寫 Docker Compose 的相關知識，注意事項如下:</p> <ul><li>直接在 Windows 用指令建置環境實在太陰間(Docker bind amount 在 Window 環境下會有些許路徑問題)，所以最後產出將會是使用 Docker Compose 來啟動環境</li> <li>請配置適合的記憶體空間給 Docker Desktop，Elastic Stack 需要一定的記憶體空間，請依據環境中的 Docker 配置此篇使用WSL2</li> <li>Docker Commands 傳送門 <a href="https://docs.docker.com/engine/reference/commandline/docker/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/commandline/docker/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="行前準備"><a href="#行前準備" class="header-anchor">#</a> 行前準備</h2> <p>已 WSL2 的基本配置大機率是啟動不了此篇 Elastic stack 的全部服務，配置一下 WSL2 的相關記憶體設定，在這個路徑下面添加設定檔(根據當下 Docker 環境設定記憶體)</p> <p><code>C:\Users\{UserName}\.wslconfig</code></p> <p>設定檔裡面添加記憶體 (memory) 的設定</p> <div class="language-EditorConfig extra-class"><pre class="language-editorconfig"><code><span class="token section selector"><span class="token punctuation">[</span>wsl2<span class="token punctuation">]</span></span>
<span class="token key attr-name">memory</span><span class="token value attr-value"><span class="token punctuation">=</span>4GB</span>
</code></pre></div><p>WSL2幾個實用指定:</p> <ul><li>View the list of distros and their current state : <code>wsl -l -v</code></li> <li>Shutdown everything : <code>wsl --shutdown</code></li> <li>Boot up the default distro : <code>wsl</code></li> <li>Boot up a specific distro : <code>wsl -d &lt;DistroName&gt;</code></li></ul> <h2 id="elastic-stack-最基本架構"><a href="#elastic-stack-最基本架構" class="header-anchor">#</a> Elastic stack 最基本架構</h2> <ol><li><p>Elasticsearch</p> <p>做為整個 Elastic stack 服務的核心，一個以 Lucene 為基礎實現的全文索引 NoSQL 資料庫，最終所有的資料與數據將在此處持久化</p></li> <li><p>Kibana</p> <p>此服務提供 UI 介面來操作持久化在 Elasticsearch 中的資料，並提供視覺化儀表板，另外也可以作為管理 Elastic stack 相關服務的後台</p></li> <li><p>Logstash</p> <p>通常出現 Elasticsearch 之前，用於數據再倒入 Elasticsearch 之前，將資料清洗並輸入，主要由三個部分組成分別是 Input &gt; Filter &gt; Output，之後會再 Logstash 的設定中看到</p></li> <li><p>FileBeat</p> <p>其原始稱呼其實為 &quot;Beats&quot;，用於將資料傳輸至 Elasticsearch 或 Logstash，這邊使用 FileBeat， Elastic stack 中 &quot;Beats&quot; 的總類有很多種常見的有 Metricbeat、Filebeat、WinLogBeat、Heartbeat......等等，可以依需求使用相應的 &quot;Beats&quot;</p></li> <li><p>NGINX(非Elastic stack)</p> <p>一個非同步框架的網頁伺服器，非 Elastic stack 只是這邊Demo架構需要一個資料提供者較容易展示結果，這裡會將 NGINX 中的 Log 藉由 FileBeat 傳送至 Logstash，之後將持久化至 Elasticsearch 並由 Kibana 來展示數據</p></li></ol> <h2 id="用-docker-建置-elastic-stack"><a href="#用-docker-建置-elastic-stack" class="header-anchor">#</a> 用 Docker 建置 Elastic stack</h2> <p>以下使用 Docker 來建置 Elastic stack，在搭建服務之前需要先創建一個 docker network，之後建置的服務都會使用這個 Network 來溝通;以 Birdge 模式創建一個名為 elknetwork 的 Docker network</p> <p><code>docker network create elknetwork</code></p> <p>接下來我們一次把需要的 Image 都拉取下來，一個沉重的建議，在同一個應用下，版本號&quot;盡量全部統一&quot;，官方的倉庫走這邊 <a href="https://www.docker.elastic.co/" target="_blank" rel="noopener noreferrer">https://www.docker.elastic.co/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，要從 Docker hub 上拉取也是可以</p> <ul><li>Elasticsearch : <code>docker pull docker.elastic.co/elasticsearch/elasticsearch:7.17.4</code></li> <li>Kibana : <code>docker pull docker.elastic.co/kibana/kibana:7.17.4</code></li> <li>Logstash : <code>docker pull docker.elastic.co/logstash/logstash:7.17.4</code></li> <li>Filebeat : <code>docker pull docker.elastic.co/beats/filebeat:7.17.4</code></li> <li>NGINX(直接抓最新版本) : <code>docker pull nginx</code></li></ul> <p>拉取成功的話長這樣</p> <div class="language-sh extra-class"><pre class="language-sh"><code>D:<span class="token punctuation">\</span>DockerHub<span class="token punctuation">\</span>ELK<span class="token operator">&gt;</span>docker images
REPOSITORY                                      TAG       IMAGE ID       CREATED       SIZE
nginx                                           latest    0e901e68141f   <span class="token number">3</span> weeks ago   142MB
docker.elastic.co/elasticsearch/elasticsearch   <span class="token number">7.17</span>.4    d64cccab426e   <span class="token number">4</span> weeks ago   630MB
docker.elastic.co/beats/filebeat                <span class="token number">7.17</span>.4    7675b1be93e0   <span class="token number">4</span> weeks ago   280MB
docker.elastic.co/logstash/logstash             <span class="token number">7.17</span>.4    93aa11296788   <span class="token number">4</span> weeks ago   798MB
docker.elastic.co/kibana/kibana                 <span class="token number">7.17</span>.4    86967a98433b   <span class="token number">4</span> weeks ago   821MB
</code></pre></div><p>方丈為人比較小心眼，先各自啟動看看是不是能正常運作，再來編寫 Docker Compose 文件處理持久化跟設定，直接下 <code>docker run</code> 啟動看看:</p> <ol><li><p>Elasticsearch :</p> <ol><li><p>先以單節點模式啟動 Elasticsearch ; docker 指令</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run -d ^
--name myelasticsearch ^
--network elknetwork ^
-p <span class="token number">9200</span>:9200 ^
-e <span class="token string">&quot;discovery.type=single-node&quot;</span> ^
docker.elastic.co/elasticsearch/elasticsearch:7.17.4
</code></pre></div></li> <li><p>啟動後至 <code>http://localhost:9200/</code> 察看結果，看到以下畫面就是啟動成功了&quot;You Know, for Search&quot;<br> <img src="/BookELK/assets/img/elastichost.4d6faea4.png" alt="elasticsearch_host"></p></li></ol></li> <li><p>Kibana</p> <ol><li><p>以上面啟動的 Elasticsearch 為 Host 啟動 Kibana; 兩個要點注意--network是否橋接到同一個網路介面，<code>ELASTICSEARCH_HOSTS=http://myelasticsearch:9200</code> 以當下的創建的 elasticsearch 服務為準</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run -d ^
--name mykibana ^
--network elknetwork ^
-p <span class="token number">5601</span>:5601 ^
-e <span class="token string">&quot;ELASTICSEARCH_HOSTS=http://myelasticsearch:9200&quot;</span> ^
docker.elastic.co/kibana/kibana:7.17.4
</code></pre></div></li> <li><p>啟動後至 <code>http://localhost:5601/</code> 察看結果，若啟動成功會看到以下介面<br> <img src="/BookELK/assets/img/kibanahost.e6de3560.png" alt="kibana_host"></p></li></ol></li> <li><p>Logstash</p> <ol><li><p>啟動 Logstash 這邊會映射兩個 port 號，5044 這是 default beats port; 9600 是給 Web API 使用的</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run -d ^
--name mylogstash ^
--network elknetwork ^
-p <span class="token number">5044</span>:5044 ^
-p <span class="token number">9600</span>:9600 ^
docker.elastic.co/logstash/logstash:7.17.4
</code></pre></div></li> <li><p>啟動後至 <code>http://localhost:9600/_node/pipelines?pretty</code> 應該會看到一個預設的 pipelines<br> <img src="/BookELK/assets/img/logstashhost.a0a0f4f8.png" alt="logstash_host"></p></li></ol></li> <li><p>Filebeat</p> <ol><li><p>啟動 Filebeat -strict.perms=false 不檢查配置文件 es.yml</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run -d ^
--name myfilebeat ^
--network elknetwork ^
--user<span class="token operator">=</span>root ^
-e -strict.perms<span class="token operator">=</span>false ^
docker.elastic.co/beats/filebeat:7.17.4
</code></pre></div></li> <li><p>由於沒有映射 Port 到容器外面這邊可以使用 <code>docker logs [Container]</code> 查一下 Log 輸出
啟動成功應該會在 Log 中看到以下字眼<br> <img src="data:image/png;base64,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" alt="filebeat_logs"></p></li></ol></li> <li><p>NGINX</p> <ol><li><p>毫無反應就是一個 NGINX 直接無情啟動</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">docker</span> run -d ^
--name mynginx ^
--network elknetwork ^
-p <span class="token number">7414</span>:80 ^
nginx
</code></pre></div></li> <li><p>訪問 <code>http://localhost:7414/</code> Welcome to nginx!<br> <img src="/BookELK/assets/img/NGINXhost.4fc5b206.png" alt="NGINX_host"></p></li></ol></li> <li><p>小結</p> <p>全部啟動後檢查一下結果 Docker 中會有5個容器，以下的都用不到...; 接下編寫 Docker Compose 用於啟動一個簡單的 Elastic Stack ; 我們需要額外設定的東西主要有兩項:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>mobet<span class="token operator">&gt;</span>docker <span class="token function">ps</span>
 CONTAINER ID   IMAGE                                                  COMMAND                  CREATED          STATUS          PORTS                                            NAMES
 0e09f4cb368c   nginx                                                  <span class="token string">&quot;/docker-entrypoint.…&quot;</span>   <span class="token number">8</span> minutes ago    Up <span class="token number">8</span> minutes    <span class="token number">0.0</span>.0.0:7414-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp                             mynginx
 9f4dfcaa3db0   docker.elastic.co/kibana/kibana:7.17.4                 <span class="token string">&quot;/bin/tini -- /usr/l…&quot;</span>   <span class="token number">15</span> minutes ago   Up <span class="token number">15</span> minutes   <span class="token number">0.0</span>.0.0:5601-<span class="token operator">&gt;</span><span class="token number">5601</span>/tcp                           mykibana
 a76d14ccd71d   docker.elastic.co/beats/filebeat:7.17.4                <span class="token string">&quot;/usr/bin/tini -- /u…&quot;</span>   <span class="token number">15</span> minutes ago   Up <span class="token number">15</span> minutes                                                    myfilebeat
 90789d97e6bc   docker.elastic.co/logstash/logstash:7.17.4             <span class="token string">&quot;/usr/local/bin/dock…&quot;</span>   <span class="token number">30</span> minutes ago   Up <span class="token number">30</span> minutes   <span class="token number">0.0</span>.0.0:5044-<span class="token operator">&gt;</span><span class="token number">5044</span>/tcp, <span class="token number">0.0</span>.0.0:9600-<span class="token operator">&gt;</span><span class="token number">9600</span>/tcp   mylogstash
 ab772cb2f745   docker.elastic.co/elasticsearch/elasticsearch:7.17.4   <span class="token string">&quot;/bin/tini -- /usr/l…&quot;</span>   <span class="token number">44</span> minutes ago   Up <span class="token number">44</span> minutes   <span class="token number">0.0</span>.0.0:9200-<span class="token operator">&gt;</span><span class="token number">9200</span>/tcp, <span class="token number">9300</span>/tcp                 myelasticsearch
</code></pre></div><ul><li>將 Elastic Stack 中必要的資料持久化至硬碟(windows 環境下直接用 docker 指令做 bind mounts 真得太過陰間...)</li> <li>將 Elastic Stack 需要使用的設定檔 Bind 到指定的實體位置，方便修改</li> <li>添加一些更詳細的設定</li> <li>下章節用 Docker Compose 來建置環境</li></ul></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/BookELK/Example/DiscordGossip.html" class="prev">
        Discord bot
      </a></span> <span class="next"><a href="/BookELK/Elasticstack/buildenvwithdockercompose.html">
        Elastic stack 環境建置(docker compose)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/BookELK/assets/js/app.1cd25600.js" defer></script><script src="/BookELK/assets/js/2.871b5155.js" defer></script><script src="/BookELK/assets/js/6.ae9ceff3.js" defer></script>
  </body>
</html>
